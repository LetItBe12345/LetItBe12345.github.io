---
import Layout from '../layouts/Layout.astro';
import Navigation from '../components/Navigation.astro';
import Footer from '../components/Footer.astro';
import fs from 'fs';
import path from 'path';

// Load news data
let news = [];
try {
  const newsPath = path.join(process.cwd(), 'src', 'content', 'news.json');
  const newsContent = fs.readFileSync(newsPath, 'utf-8');
  news = JSON.parse(newsContent);
} catch (error) {
  console.warn('Could not load news:', error.message);
}
---

<Layout title="News - Dr. Your Name">
  <Navigation />
  
  <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <div class="mb-12">
      <h1 class="text-4xl font-bold text-gray-900 dark:text-white mb-4">Latest News</h1>
    </div>

    <div class="space-y-3">
      {news.length === 0 && (
        <div class="text-center py-12">
          <p class="text-gray-500 dark:text-gray-400">
            No news found. Add your news to <code>src/content/news.json</code>
          </p>
        </div>
      )}
      
      {news.map((item, index) => {
        const date = new Date(item.date);
        const formattedDate = date.toLocaleDateString('en-US', { 
          year: 'numeric', 
          month: 'long', 
          day: 'numeric' 
        });
        
        return (
          <div class="flex items-center justify-between py-2 border-b border-gray-200 dark:border-gray-700">
            <p class="text-gray-900 dark:text-white">
              <span class="font-medium">{formattedDate.replace(/(\w+) (\d+), (\d+)/, '$1 $3:')} </span>
              {item.title}
              {item.link && (
                <a
                  href={item.link}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 ml-2"
                >
                  â†’
                </a>
              )}
            </p>
          </div>
        );
      })}
      
      {news.length > 0 && (
        <div class="mt-8">
          <div class="flex items-center justify-between py-2">
            <p class="text-gray-900 dark:text-white">
              <span class="font-medium">View more news and updates...</span>
            </div>
        </div>
      )}
    </div>
  </main>

  <Footer />
</Layout>